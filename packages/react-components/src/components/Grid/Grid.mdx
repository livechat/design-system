import { Meta, Title, Canvas, ArgTypes } from '@storybook/blocks';

import * as Stories from './Grid.stories';

<Meta of={Stories} />

<Title>Grid</Title>

[Intro](#Intro) | [Usage](#Usage) | [Breakpoints](#Breakpoints) | [Gutters](#Gutters) | [Margins](#Margins) | [Alignment](#Alignment) | [Column System](#ColumnSystem) | [Component API](#ComponentAPI)

## Intro <a id="Intro" />

The `Grid` component provides a flexible and responsive layout system based on Flexbox. It helps create consistent layouts across different screen sizes using a column-based system.

## Usage <a id="Usage" />

> Note: In the examples below, some stories include a grid overlay to help visualize the column structure. 
> This overlay is only available in Storybook and is not part of the actual component.

Here's a basic example of how to use the Grid system:

```tsx
import { Grid, Column } from '@livechat/design-system-react-components';

return (
  <Grid>
      <Column lg={8}>
        <div>Half width on large screens</div>
      </Column>
      <Column lg={8}>
        <div>Half width on large screens</div>
      </Column>
      <Column lg={4}>
        <div>Quarter width</div>
      </Column>
      <Column lg={4}>
        <div>Quarter width</div>
      </Column>
      <Column lg={4}>
        <div>Quarter width</div>
      </Column>
      <Column lg={4}>
        <div>Quarter width</div>
      </Column>
  </Grid>
);
```

## Breakpoints <a id="Breakpoints" />

The grid system uses five breakpoints by default, implemented using CSS Container Queries:

```scss
$breakpoints: (
  sm: 320px,   // Small devices
  md: 672px,   // Medium devices
  lg: 1024px,  // Large devices
  xl: 1312px, // Extra large devices
  2xl: 1584px  // Maximum width
);
```

> **Important**: Since the breakpoints are implemented using Container Queries, the `Column` components must be direct children of the `Grid` component for the responsive behavior to work properly. Wrapping a `Column` in another element will break the responsive functionality.

```tsx
// ✅ Correct usage - Column is direct child of Grid
<Grid>
  <Column lg={6}>Content</Column>
</Grid>

// ❌ Incorrect usage - Column is not direct child
<Grid>
  <div>
    <Column lg={6}>Content</Column>
  </div>
</Grid>
```

> **Note for TextApp**: Since TextApp is designed with a minimal layout width of 1024px (corresponding to the `lg` breakpoint), you may not need to implement responsive behaviors for smaller breakpoints (`sm` and `md`). Focus on using `lg`, `xlg`, and `max` breakpoints for your layout needs.

## Gutters <a id="Gutters" />

Gutters are the spaces between columns in the grid system. The Grid component handles gutters automatically with the following characteristics:

- Default gutter values are:

```scss
$default-gutters: (
  sm: var(--spacing-4), // 16px
  md: var(--spacing-4), // 16px
  lg: var(--spacing-4), // 16px
  xl: var(--spacing-4), // 16px
  2xl: var(--spacing-6), // 24px
);
```

```tsx
<Grid>
  <Column lg={6}>
    {/* This column has 16px gutter on the right */}
  </Column>
  <Column lg={6}>
    {/* This column has 16px gutter on the left */}
  </Column>
</Grid>
```

### Custom Gutters

If you need to  override gutters for specific use cases, you can use the gutter prop:

```tsx
<Grid gutter={{sm: 2, md: 10, lg: 24}}>
  <Column lg={6}>
  </Column>
</Grid>
```

## Margins <a id="Margins" />

The Grid component supports configurable margins around the entire grid container. Like gutters, margins can be customized for different breakpoints.

### Default Margins

By default, the Grid component uses the following margin values:

```scss
$default-margins: (
  sm: var(--spacing-8), // 32px
  md: var(--spacing-8), // 32px
  lg: var(--spacing-8), // 32px
  xl: var(--spacing-8), // 32px
  2xl: var(--spacing-8), // 32px
);
```

### Custom Margins

You can override the default margins using the `margin` prop. This prop accepts values for different breakpoints:

```tsx
<Grid margin={{
  sm: 16,    
  md: 24,      
  lg: 32,    
  xl: 40,    
  '2xl': 48 
}}>
  <Column lg={6}>Content</Column>
  <Column lg={6}>Content</Column>
</Grid>
```

The margin prop accepts either:
- Numbers (interpreted as pixels)
- Strings (any valid CSS margin value, e.g., "2rem", "5%")

## Alignment <a id="Alignment" />

The Grid component supports both vertical and horizontal alignment of columns through the `align` and `justify` props.

### Vertical Alignment (align)

The `align` prop controls the vertical alignment of columns within a row. Available options:
- `start` (default): Aligns columns to the top
- `center`: Centers columns vertically
- `end`: Aligns columns to the bottom

```tsx
<Grid align="center">
  <Column lg={4}>
    <div style={{ height: '100px' }}>Tall content</div>
  </Column>
  <Column lg={4}>
    <div style={{ height: '50px' }}>Short content</div>
  </Column>
  <Column lg={4}>
    <div style={{ height: '75px' }}>Medium content</div>
  </Column>
</Grid>
```

### Horizontal Alignment (justify)

The `justify` prop controls the horizontal distribution of columns. Available options:
- `start` (default): Aligns columns to the left
- `center`: Centers columns horizontally
- `end`: Aligns columns to the right
- `space-between`: Maximizes space between columns
- `space-around`: Distributes space evenly around columns

```tsx
<Grid justify="space-between">
  <Column lg={3}>
    <div>Left content</div>
  </Column>
  <Column lg={3}>
    <div>Center content</div>
  </Column>
  <Column lg={3}>
    <div>Right content</div>
  </Column>
</Grid>
```

### Combined Alignment

You can combine both `align` and `justify` props for precise control over column positioning:

```tsx
<Grid align="center" justify="center">
  <Column lg={4}>
    <div>Centered both vertically and horizontally</div>
  </Column>
  <Column lg={4}>
    <div>Also centered</div>
  </Column>
</Grid>
```

## Column System <a id="ColumnSystem" />

The grid uses a consistent 12-column system across all breakpoints. This makes it simple to create predictable layouts that work across all screen sizes.

Common column spans and their percentages:
- 12 columns = 100%
- 6 columns = 50%
- 4 columns = 33.33%
- 3 columns = 25%
- 2 columns = 16.67%
- 1 column = 8.33%

### Column Props

```tsx
<Column 
  sm={6}   // Takes 6 of 12 columns (50%) on small screens
  md={6}   // Takes 6 of 12 columns (50%) on medium screens
  lg={6}   // Takes 6 of 12 columns (50%) on large screens
  xlg={6}  // Takes 6 of 12 columns (50%) on extra large screens
  max={6}  // Takes 6 of 12 columns (50%) on maximum screens
>
  Content
</Column>
```

Each breakpoint prop accepts:
- A number from 1 to 12 representing the number of columns to span
- The value `'auto'` for automatic width adjustment

### Auto-width Columns

You can create flexible columns that automatically adjust their width:

```tsx
<Grid>
  <Column>
    Auto width
  </Column>
  <Column>
    Auto width
  </Column>
</Grid>
```

### Nested Grids

The Grid system supports nesting:

```tsx
<Grid>
    <Column lg={8}>
      <Grid>
        <Column lg={8}>Nested content</Column>
        <Column lg={8}>Nested content</Column>
      </Grid>
    </Column>
    <Column lg={8}>
      Regular content
    </Column>
</Grid>
```

#### Nested Grid Proportions

When using nested grids, it's important to understand how column widths relate to each other. Each grid is divided into 16 columns, and when you nest a grid inside a column, that column becomes the new "100%" width for the nested grid.

For example:
- If you have a column that's `lg={4}` (4/16 = 25% of the outer grid)
- And inside it, you place a nested grid with a column that's `lg={8}` (8/16 = 50% of the nested grid)
- The nested column will actually occupy 50% of 25% of the total width, which equals 12.5% of the outer grid width
- This is equivalent to a `lg={2}` column in the outer grid (2/16 = 12.5%)

This proportional relationship helps maintain consistent spacing and alignment throughout your layout hierarchy.


### Column Sizing Methods

The Column component supports three different approaches to sizing:

1. **Grid-based sizing** (using breakpoint props)
```tsx
<Column sm={2} md={4} lg={8}>
  {/* Takes specific column spans at different breakpoints */}
</Column>
```

2. **Direct width control**
```tsx
<Column width="200px">
  {/* Fixed width column */}
</Column>

<Column width="50%">
  {/* Percentage-based width */}
</Column>
```

3. **Flexible with constraints**
```tsx
<Column minWidth="150px" maxWidth="300px">
  {/* Flexible column with size constraints */}
</Column>
```

> **Important**: These sizing methods are mutually exclusive. You cannot mix breakpoint-based sizing (sm, md, lg, etc.) with direct width control or constraints.

#### Width Properties

- `width`: Sets a fixed width for the column (CSS width value)
- `minWidth`: Sets a minimum width constraint (CSS width value)
- `maxWidth`: Sets a maximum width constraint (CSS width value)

These properties accept any valid CSS width value (px, %, rem, etc.).

#### Usage Guidelines

1. **Breakpoint-based sizing**
   - Best for responsive layouts that need different widths at different screen sizes
   - Uses the grid's column system

2. **Direct width control**
   - Best for fixed-width columns
   - Cannot be used with breakpoint props (sm, md, lg, etc.)

3. **Flexible with constraints**
   - Best for columns that need to flex while respecting size limits
   - Can use minWidth and/or maxWidth independently
   - Works with the auto-flexible behavior

#### Examples

```tsx
// Fixed width
<Column width="200px">Fixed width</Column>

// Breakpoint-based width
<Column 
  sm={4}
  md={6}
  lg={8}
>
  Grid breakpoint column based width
</Column>

// Auto-flexible (default behavior)
<Column>Flexible width</Column>
``` 



## Component API <a id="ComponentAPI" />

### Grid Props

<ArgTypes of={Stories.Default} include={['fullWidth', 'className']} />

### Column Props

<ArgTypes of={Stories.Default} />